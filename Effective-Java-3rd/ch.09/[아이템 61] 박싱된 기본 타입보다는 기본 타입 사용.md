# [아이템 61] 박싱된 기본 타입보다는 기본 타입을 사용하라

### 자바의 데이터 타입

- 기본 타입
    - int, long, double
- 참조 타입
    - String, List

**박싱된 기본 타입**

기본 타입 각각에 대응하는 참조 타입

- Integer, Double, Boolean

### 기본 타입과 박싱된 기본 타입의 차이

1. **식별성 유무**
    1. 기본 타입은 값만 가지고 있으나, 박싱 타입은 값에 더해 **식별성(identity)을** 가짐
    2. 박싱 타입의 두 인스턴스는 **값이 같아도 서로 다르다고 식별**될 수 있음
2. **항상 유효한 값인가?**
    1. 기본 타입의 값은 언제나 유효하나, 박싱 타입은 유효하지 않은 값(null)을 가질 수 있음
3. **시간 및 메모리 효율**
    1. 기본 타입이 박싱 타입보다 시간과 메모리 사용면에서 효율적

→ 분명히 차이가 존재하므로, 주의하지 않고 사용하면 큰 문제 발생 가능!

### 코드 예시

Integer 값을 오름차순으로 정렬

```java
// 잘못 구현된 비교자
Comparator<Integer> naturalOrder = (i, j) -> (i < j) ? -1 : i == j ? 0 : 1);
```

`new Integer(42)`와 `new Integer(42)` 는 다르므로, 값이 같아도 1을 출력

- `i < j` 는 기본 타입으로 변환되므로 정상 수행
- `i == j` 에서 객체 참조의 식별성을 검사 → 서로 다른 인스턴스라면 false

```java
// 문제를 수정한 비교자
Comparator<Integer> naturalOrder = (iB, jB) -> {
  int i = iB, j = jB; // auto boxing
  return (i < j) ? -1 : (i == j ? 0 : 1);
}
```

```java
// 기이하게 동작하는 프로그램
public class Unbelievable {
  static Integer i;
  public static void main(String[] args) {
    if (i == 42)
      sout("Unbelievable"):
  }
```

i == 42 를 검사할때, NPE 를 던진다! (Integer와 int를 비교)

- **기본 타입과 박싱 타입을 혼용하면 박싱 타입의 박싱이 자동으로 풀린다.**
- null 참조를 언박싱하면 NPE 발생

→ i를 int로 선언해주면 해결

```java
Long sum = 0L;
for (long i = 0; i <= Integer.MAX_VALUE; i++) {
  sum += i; // 박싱과 언박싱이 반복 발생 -> 성능 하락
}
sout(sum);
```

### 박싱 타입은 언제 써야 하는가?

- 컬렉션의 원소, 키, 값 (컬렉션은 기본 타입을 쓸 수 없으므로)
    - **매개변수화** **타입, 매개변수 메서드의 타입 매개변수**로는 박싱 타입을 써야 한다.
- 리플렉션을 통해 메서드 호출 시